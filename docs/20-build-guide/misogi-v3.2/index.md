---
title: 禊 v3.2 ビルドガイド
authors: [nekoha]
date: 2025-01-07
# image: ./misogi-QR.png
---

## v3.2 の特徴

禊シリーズ`v3.2`版です。  
`v3.1`から細かい部品配置変更があり、ソケットが最初からはんだ付け済みになっています。

### バリエーション

有線/無線で大まかに別れますが、ケースのバリエーションが 3 種類あります。  
ケースは 3D プリンタ製で、自分で印刷できる環境を持っている方も多いのでオプション扱いにしました。

- 基盤 A: ProMicro 用
  - 基盤のみのキットで、ケースは自分で用意します
- 基盤 B: `BLE Micro Pro`(以下 BMP と表記) 用電源キット付き
  - BMP を使うための電源回路を追加
  - 電源を時前で用意するなら基盤 A でも使えます
- 基盤 A 用ケース
  - ProMicro に合うケース、電源キットでは使えません
- 基盤 B 用ケース: 電池カバーなし
  - 電源キットで利用
  - 電池は開放型で常に見えるタイプ
- 基盤 B 用ケース: 電池カバーあり
  - 電源キットで利用
  - 電池はフタ付きでスッキリ見えるタイプ

## このビルドガイドについて

BMP を使った無線版で説明しています。  
電源パーツがない以外、ProMicro 版も組み立て方は一緒です。

## パーツリスト

### キットに付属するもの

- 基盤
- 電源部品(ProMicro 版には付属しません)
  - 昇圧コンバータ
  - トグル式電源スイッチ
  - 単 4 電池ボックス

### ケース

ケースは BOOTH で購入できます。  
自分でプリントもできますが、その場合ネジとゴム足を別途ご用意ください。

- スイッチプレート
- ボトムプレート
- トップケース
- ネジ M2x8mm 6 本
- ゴム足 4 個

### 別売り(ご自分で用意してください)

これらはキットに付属しないので、ご自分で用意してください。

- MX 互換キースイッチ 34 個
- 上記キースイッチとの互換キーキャップ 1u 34 個
- マイコンボード
- BMP 版の場合
  - `BLE Micro Pro`(下記参照)
  - 12pin か 13pin のコンスルー、またはピンヘッダ(2.5mm 高)
- ProMicro 版の場合
  - `ProMicro`互換マイコン
  - 12pin のコンスルー、またはピンヘッダ(2.5mm 高)

## パーツの参考購入先

### ご自分で用意するもの(キットに含まれないもの)

- BLE Micro Pro(どちらで購入しても OK)
  - [BLE Micro Pro Type-C 版: 遊舎工房](https://shop.yushakobo.jp/products/ble-micro-pro?variant=37665571340449)
  - [Pro Micro サイズの USB 対応 nRF52 マイコンボード: のぎけす屋](https://booth.pm/ja/items/1177319)
- Pro Micro
  - [Pro Micro Type-C 版: 遊舎工房](https://shop.yushakobo.jp/products/3905)
- コンスルーピン x2
  - 12 or 13 ピンで 2.5mm 高が適合します
  - [コンスルー: 遊舎工房](https://shop.yushakobo.jp/products/31?variant=37665714405537)
  - [MAC8 コンスルー XB-3-2.5-12P \(高さ 2.5mm/12 ピン/1 個\): TALP KEYBOARD](https://talpkeyboard.net/items/5e056626d790db16e2889233)

## マイコンの用意

### マイコンの用意(BMP 版)

BMP を組み付け、ファームウェアを書き込みます。  
`Vial` に対応しています。

1. [ブートローダーをアップデートする](https://sekigon-gonnoc.github.io/BLE-Micro-Pro-WebConfigurator/#/update/bootloader)
   1. バージョン `ble_micro_pro_bootloader_1_2_2` を選び、BMP を USB 接続して `Update` をクリック
   2. 接続、書き込みが終わったら次に進むようメッセージが表示されます
   3. 1 回目は接続だけで終わってしまうことがあるので、表示メッセージを確認してください
2. [アプリケーションをアップデートする](https://sekigon-gonnoc.github.io/BLE-Micro-Pro-WebConfigurator/#/update/application)
   1. バージョン `ble_micro_pro_vial_1_2_3` を選び、BMP を USB 接続して `Update` をクリック
   2. 接続、書き込みが終わったら次に進むようメッセージが表示されます
   3. 1 回目は接続だけで終わってしまうことがあるので、表示メッセージを確認してください
3. [BMP 版ファームウェアをダウンロード](/firmwares/禊v3/bmp-misogi-v3.zip)して解凍
4. マイコンボードを USB 接続すると、ドライブとして認識されます
   1. 解凍したファイルを上書きコピーしてください
5. コピーが終わったら[Vial Web](https://vial.rocks/)からキーマップをリアルタイムに編集できます！
   1. 繋がらない場合はいったんケーブルを抜いて再接続してみてください(初回はちょっと不安定)

### マイコンの用意(ProMicro 版)

ProMicro を組み付け、ファームウェアを書き込みます。  
`Vial` に対応しています。

- `Pro Micro` の場合、基盤の一番外側にあるピンは使いません(向かって左側を 1 つあける)
- [Pro Micro 版ファームウェア](/firmwares/禊v3/promicro-misogi-v3.zip)をダウンロード
- [QMK toolbox](https://github.com/qmk/qmk_toolbox/releases)などを使ってファームウェアを書き込んでください
- ファームウェア書き込みが終わったら[Vial Web](https://vial.rocksob/)からキーマップをリアルタイムに編集できます！
  - 繋がらない場合はいったんケーブルを抜いて再接続してみてください

**※ Pro Micro のバリエーション**  
`Pro Micro` の種類によっては、USB Type-C to Type-C での接続ができません。  
遊舎工房で扱っている[Pro Micro Type-C 版](https://shop.yushakobo.jp/products/3905)では動作確認できています。  
BMP 互換サイズで販売されているものもありますが、多くが旧型で、PC 側が Type-A しか対応していない場合もあります。  
お手持ちのコントローラボードが Type-C 接続に対応しているかの質問には答えられませんのでご了承ください。

### キーマップについて

配布バージョンのキーマップは私が普段から愛用しているものですが、ちょっとクセがあるかもしれません。  
ご自身で最適なキーマップを探求してください！

→ [クセありなキーマップの紹介はこちら](/blog/2024/07/13/keymaps)

## 組み立て

![予備ハンダ](./img/v3.2__00.jpg)

### 電池ボックスの取り付け

※ ProMicro 版は [マイコンボードの取り付け](#マイコンボードの取り付け) までスキップしてください。

電池ボックスは、左側が `+` になるように設置してください。

電池ボックスの端子を PCB に通したら、マスキングテープなどで固定してください。  
![電池ボックスを固定](./img/v3.2__01.jpg)

端子はほんのちょっとあれば PCB とくっつくので、ギリギリ残して切ってください。  
具体的にはボトムプレートの隙間が 1.8mm と、周り 5mm 四方までしか許容しないので、そこに収まるように切ります。  
切り取ったらはんだ付け。

![端子を切り取る](./img/v3.2__02.jpg)

### 昇圧コンバータの取り付け

まずは付属のピンヘッダを 3 ピンずつに分けます。

ピン側を PCB 基盤に固定します。  
マスキングテープなどでまっすぐに固定してください。  
![ピンヘッダの用意](./img/v3.2__03.jpg)

裏側からはんだ付けします。  
余った端子は切ってください。
![ピンヘッダをはんだ付け](./img/v3.2__04.jpg)

基盤の `I`, `G`, `O` のマークとコンバータの `I`, `G`, `O` マークを合わせるように載せてください。

![コンバータを取り付ける](./img/v3.2__05.jpg)

### 電源スイッチの取り付け

電源スイッチを組み付けます。
スイッチのリング外周には継ぎ目があります。継ぎ目を奥にする方が見た目が良くなります。  
![電源スイッチを載せる](./img/v3.2__06.jpg)

電源スイッチがぐらつかないように、マスキングテープなどで仮止めします。
![電源スイッチを仮止め](./img/v3.2__07.jpg)

裏側から５ピン全部はんだ付けします。  
![電源スイッチをはんだ付け](./img/v3.2__08.jpg)

### マイコンボードの取り付け

コンスルーピンをマイコンに組み付けます。  
**マイコンボードは背面(電子パーツが少ない方)が上になります(写真参照)。**  
コンスルーまたはピンヘッダは高さ `2.5mm` のタイプを選んでください。

このままでも動きますが、抜き差しするときにピンが曲がりやすいのでマイコン側ははんだ付けをおすすめします。  
USB 端子反対側の 9 番と 35 番は使っていないので、 ProMicro 用の 12 ピンコンスルーでも動作します。

### スイッチプレート、スイッチの取り付け

まずボトムプレートを敷き、その上に基盤とスイッチプレートを乗せます。  
スイッチプレート最下段は右側に切り欠きが来るようにセットしてください。

スイッチをはめ込んでいきます。  
スイッチの足をまっすぐにして、ゆっくり差し込んでください。  
先に左右のスイッチをはめ込むと位置が決まりやすくなります。  
![スイッチを差し込む1](./img/v3.2__10.jpg)

図のように、全部ではなく一部を残してはめ込んでください。  
全部差し込んでいるとトップケースを取り付けにくくなります。  
![スイッチを差し込む2](./img/v3.2__11.jpg)

### トップケースの取り付け

トップケースを被せます。  
向かって左、マイコン側から被せていきます。  
![](./img/v3.2__12.jpg)

ケースを被せたら、残りのスイッチを全て取り付けます。  
USB ケーブル経由で `vial` に接続し、テスターモードですべてのキーが反応することを確認して下さい。  
![スイッチ動作確認](./img/v3.2__13.jpg)

### ボトムプレートの取り付け

裏返して、ネジ穴 6 箇所にネジを締め込んでください。  
![ネジ締め](./img/v3.2__14.jpg)

### ゴム足の貼付け

コーナーに 4 点、ゴム足を取り付けます。  
ぎりぎりの角だと押し込んだときにたわむので、スイッチの真下あたりが良いです。  
![ゴム足の取り付け](./img/v3.2__15.jpg)

### 電池ボックスの取り付け(有線タイプの場合はありません)。

電池ボックスに電池を入れます。  
![電池をいれる](./img/v3.2__16.jpg)

蓋を取り付けます(有線タイプ、または開放型の場合はありません)。  
![蓋を閉める](./img/v3.2__17.jpg)

## 完成

以上で完成となります、お疲れ様でした！  
USB での電源供給時は LED を光らせることもできます。  
![完成！](./img/v3.2__18.jpg)

[#misogi34](https://x.com/search?q=%23misogi34) のハッシュタグをつけて投稿してもらえると励みになります！  
最初は慣れるまで苦しいですが、ぜひ使いこなしてください！

ご意見、ご要望もお待ちしています！

## WIP: 付録

ファームウェアと STL ファイルを提供する

- [禊 v3.2 用ファームウェア(ProMicro)](/firmwares/禊v3.2/promicro-misogi-v3.zip)
- [禊 v3.2 用ファームウェア(BMP)](/firmwares/禊v3.2/misogi-bmp-v3.2.zip)
- [禊 v3.2 用 3D プリント用 STL ファイル](/firmwares/禊v3.2/stl-misogi-v3.2.zip)

## 履歴

- 2025-01-20 公開
