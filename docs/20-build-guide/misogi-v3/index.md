---
title: 禊 v3 ビルドガイド
authors: [nekoha]
date: 2024-07-23
update: 2024-07-23
# image: ./misogi-QR.png
draft: true
---

## v3 の特徴

禊シリーズ最新作。

- 禊シリーズ初、`LED` 搭載
- さらにコンパクト
- さらにビルドが簡単に

## パーツリスト

- 付属

  - 基盤
  - スイッチレイヤー
  - ボトムケース
  - トップケース
  - M3x8mm 11 本
  - ゴム足 3 個
  - かんざし(キースイッチの取り付け補助に使います)
  - 電源キット付きは以下も付属します
    - 昇圧回路
    - 電源スイッチ
    - 電池ボックス

- 別売り(ご自分で用意してください)
  - MX 互換キースイッチ 34 個
  - MX 互換キーキャップ 1u 34 個
  - コントローラ
    - `Pro Micro` or `BLE Micro Pro`(下記参照)
  - 12pin か 13pin のコンスルー、またはピンヘッダ

### 参考購入先

- Pro Micro
  - [Pro Micro Type-C 版: 遊舎工房](https://shop.yushakobo.jp/products/3905)
- BLE Micro Pro
  - [BLE Micro Pro Type-C 版: 遊舎工房](https://shop.yushakobo.jp/products/ble-micro-pro?variant=37665571340449)
  - [Pro Micro サイズの USB 対応 nRF52 マイコンボード: のぎけす屋](https://booth.pm/ja/items/1177319)
- 電源キット(キットに付属していますので、スペアが必要なら)
  - [XCL103 使用 3.3V 出力昇圧 DCDC コンバーターキット: 秋月電子](https://akizukidenshi.com/catalog/g/g116116/)
    - 品薄・・・
    - [3.3V 出力昇圧 DCDC コンバーター: 秋月電子](https://akizukidenshi.com/catalog/g/g113066/)も互換性ありそう
  - [電池ボックス 単 4×1 本 ピン: 秋月電子](https://akizukidenshi.com/catalog/g/g102670/)
  - [基板用小型 3P トグルスイッチ 1 回路 2 接点: 秋月電子](https://akizukidenshi.com/catalog/g/g112407/)
  - [押しボタンスイッチ 黒・オルタネート 6mm 角 PB-22E60L: 秋月電子](https://akizukidenshi.com/catalog/g/g115968/)

## コントローラの取り付け

コントローラを組み付け、ファームウェアを書き込みます。  
`Vial` に対応しています。

配布バージョンのキーマップは私が普段から愛用しているものですが、ちょっとクセがあるかもしれません。  
ご自身で最適なキーマップを探求してください！

→ [クセありなキーマップの紹介はこちら](/mobneko-keebs-doc/blog/2024/07/13/keymaps)

### 無線化しない場合(ProMicro)

通常の `Pro Micro` を使います。  
**コントローラは背面(電子パーツが少ない方)**が上になります(基盤にプリントされているのピン配置と合うように確認してください)。
コンスルーまたはピンヘッダは USB 端子の上面が基盤から 4mm 以内となるような高さにしてください。

- `Pro Micro` の場合、基盤の一番外側にあるピンは使いません(向かって左側を 1 つあける)
- [Pro Micro 版ファームウェアをダウンロード](/firmwares/禊v3/promicro-misogi-v3.zip)
- [QMK toolbox](https://github.com/qmk/qmk_toolbox/releases)などを使ってファームウェアを書き込んでください
- ファームウェア書き込みが終わったら[Vial Web](https://vial.rocks/)からキーマップをリアルタイムに編集できます！
  - 繋がらない場合はいったんケーブルを抜いて再接続してみてください

**※ Pro Micro のバリエーション**  
`Pro Micro` の種類によっては、USB Type-C to Type-C での接続ができません。  
遊舎工房で扱っている[Pro Micro Type-C 版](https://shop.yushakobo.jp/products/3905)では動作確認できています。  
[AliExpress などでも買えます](https://www.aliexpress.com/item/1005004900131198.html)が、PC 側が Type-A しか対応していない場合もあります。  
お手持ちのコントローラボードが Type-C 接続に対応しているかの質問には答えられませんのでご了承ください。

### 無線化する場合(BLE Micro Pro)

無線化には `BLE Micro Pro` を使います。  
**コントローラは背面(電子パーツが少ない方)**が上になります(基盤にプリントされているのピン配置と合うように確認してください)。
コンスルーまたはピンヘッダは高さ `2.5mm` のタイプを選んでください。

1. [ブートローダーをアップデートする](https://sekigon-gonnoc.github.io/BLE-Micro-Pro-WebConfigurator/#/update/bootloader)
   1. バージョン `ble_micro_pro_bootloader_1_2_0` を選び、BMP を USB 接続して `Update` をクリック
   2. 接続、書き込みが終わったら次に進むようメッセージが表示されます
   3. 1 回目は接続だけで終わってしまうことがあるので、表示メッセージを確認してください
2. [アプリケーションをアップデートする](https://sekigon-gonnoc.github.io/BLE-Micro-Pro-WebConfigurator/#/update/application)
   1. バージョン `ble_micro_pro_vial_1_2_0` を選び、BMP を USB 接続して `Update` をクリック
   2. 接続、書き込みが終わったら次に進むようメッセージが表示されます
   3. 1 回目は接続だけで終わってしまうことがあるので、表示メッセージを確認してください
3. [BMP 版ファームウェアをダウンロード](/firmwares/禊v3/bmp-misogi-v3.zip)して解凍
4. コントローラを USB 接続すると、ドライブとして認識されます
   1. 解凍したファイルを上書きコピーしてください
5. コピーが終わったら[Vial Web](https://vial.rocks/)からキーマップをリアルタイムに編集できます！
   1. 繋がらない場合はいったんケーブルを抜いて再接続してみてください(初回はちょっと不安定)

#### BMP 使用時の補足

- トグル電源スイッチの場合、奥側が `ON` になります
- 押し込み電源スイッチの場合、押し込まれた状態が `ON` になります
- ワイヤレス状態では光りません
  - LED を光らせる場合は USB 給電が必要です

## ボトムケース、スイッチレイヤの取り付け

付属の「かんざし」を使い、スイッチレイヤとキースイッチを取り付けていきます。

- ボトムケースと基盤、スイッチレイヤをネジで留めます
  - スイッチレイヤのみ、3 箇所
- スイッチレイヤはたわみやすいので、かんざしを基盤とスイッチレイヤ間に挟みながらスイッチを挿していきます

## トップケースの取り付け

- 外周部のネジを締めていきます
- プラスチックなので強い力には耐えられません
- 最大でもネジの頭が底面とフラットになるくらいにしてください

## ゴム足の貼付け

3D プリンタケースは微妙に反りやすく、底面がまっすぐになっていないです。  
厚いデスクマットの上ならそのまま使えますが、硬い机の上で使うならゴム足があったほうが良いです。

- キーボードの奥側、コーナーに 2 点
- キーボードの手前側、中央に 1 点

の 3 点に貼り付けることで安定します(キット内付属のゴム足も 3 点のみ同梱です)。  
4 点以上つけてしまうと反りのせいで逆に安定しません。

以上で完成となります、お疲れ様でした！  
[#misogi34](https://x.com/search?q=%23misogi34) のハッシュタグをつけて投稿してもらえると励みになります！

## 付録

- [3D プリント用 STL ファイル](/firmwares/禊v3/stl-misogi-v3.zip)
